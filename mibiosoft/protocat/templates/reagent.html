{% extends 'base.html' %}

{% block content %}

<style>

.card {
	display: none;
	position: absolute;
	width: 500px;
	height: 150px;
	border:2px solid #00274c;
	border-radius: 11px;
	box-shadow: 5px 5px 5px grey;
	background-color: #fff;
	margin-top: 10px;
	margin-bottom: 10px;
}

#hovercard {
	background-color: #EAC;
}

</style>

<script>

$(document).ready(function (e) {
	$("#hovercard").hover(
		function(){
			position = $(this).position();
			$(".card").show().css("top", position.bottom).css("left", position.left);
			
			$.ajax({
				method: "GET",
				url: "https://en.wikipedia.org/w/api.php?action=query&prop=revisions&rvprop=content&format=json&titles=salt",
				success: function(data) {
					var raw_text = data.query.pages[1605200].revisions["0"]["*"]
					var start_index = raw_text.indexOf("'''");
					var end_index = raw_text.indexOf("\n",start_index);
					var display_text = raw_text.substring(start_index, end_index); //Get the first paragraph of the wikipedia article

					//Format the data nicely
					display_text = display_text.replace(/'''/g,"") //Remove quotations around name
					display_text = display_text.replace(/\[\[[^\[\]]*?\([^\[]*?\)\|/g,"") //Remove variable wikipedia formatting
					display_text = display_text.replace(/\[\[[^\[\]]*?\|/g, "")//Remove variable wikipedia formatting
					display_text = display_text.replace(/{{.*?\|/g, "")
					display_text = display_text.replace(/\|.{1,3}}}/g, "")
					display_text = display_text.replace(/\|/,"")
					display_text = display_text.replace(/\[\[/g, "").replace(/]]/g,"") //Remove any remaining brackets
					console.log(display_text);
					$(".card").html(display_text);
				},
				failure: function(){
					alert("Shit happens");
				}
			})
			//$(".card").html(/*PUT THE HTML HERE*/"Words go here")
		},
		function(){
			$(".card").hide();

		});
});

</script>

<div class="col-sm-12">
	<div class="row">
		<div class="col-sm-12 padded" style = "text-align: center">
					<h2>{{ reagent.name }}</h2>
					<h4>{{ reagent.website|urlize }}</h4>
					<div class = "col-sm-4"></div>
					<div class = "col-sm-4">
					<div class = "card"></div>
				</div>
					</div>
					</div>
						{% if reagent.description != "" %}
						{{ reagent.description|safe }}

						{% else %}
						<h5 style="text-align:left">Looks like no one has written a description yet.<br></h5>
						{% endif%}

	<a href = "/editreagent/{{reagent.id}}" class = "btn btn-primary" role = "button">
		Edit this reagent</a>
	<br>

	<h4><span id="hovercard">Salt</span></h4>

</div>



{% endblock %}

<!--
<div class = "btn-group inline pull-right apply_changes_btn"> == $0
<button class = "btn" id = "edit_reactants"> Edit this reagent </button>
